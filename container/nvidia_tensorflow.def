BootStrap: docker
From: nvcr.io/nvidia/tensorflow:23.12-tf2-py3

%post

pip install nibabel==4.0.2
pip install Pillow==9.3.0
pip install wandb==0.14.0
pip install pytest==7.2.2
pip install simple-parsing>=0.1.2
pip install tqdm==4.62.3
pip install matplotlib==3.4.3
pip install seaborn==0.11.2

%environment

# Avoid CUPTI warning message
export LD_LIBRARY_PATH=${CUDA_HOME}/extras/CUPTI/lib64:${LD_LIBRARY_PATH}
export TF_FORCE_GPU_ALLOW_GROWTH=true
export XLA_FLAGS="--xla_gpu_cuda_data_dir=${CUDA_HOME}"
# enable autoclustering for CPU and GPU
export TF_XLA_FLAGS="--tf_xla_auto_jit=2 --tf_xla_cpu_global_jit"

%files

%runscript

%labels
  author Nastassya Horlava
  version 1.0

%help
  The converted Docker image for NVIDIAs Tensorflow (version 2.14).

%test